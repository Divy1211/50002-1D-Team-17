module game_fsm (
    input clk,
    input rst,
    
    input button_0,
    input button_1,
    input button_2,
    input button_3,
    input button_4,
    input button_5,
    input button_6,
    input button_7,
    input button_8,
    input button_9,

    input button_a,
    input button_b,
    input button_c,
    input button_d,

    input button_asterisk,
    input button_hash,

    input rb_data[16],

    output we,
    
    output ra[5],
    output rb[5],
    output rc[5],
    output literal[16],

    output asel,
    output bsel,
    output wdsel,
    output ra2sel,
    output alufn[6],
    output start,
    output finished,

    output state[7]
  ) {
  
  op_code_enum alu_op_code;
  regfile_address_enum regfile_addr;
  
  .clk(clk) {
    .rst(rst) {
      fsm game_state = {
        START,
        SELECT_BOX_P1,
        SELECT_SIZE_P1,
        CHECK_SIZE_SMALL_P1,
        CHECK_SIZE_MED_P1,
        CHECK_SIZE_LARGE_P1,
        VALIDATE_PLACEMENT_P1_PT1,
        VALIDATE_PLACEMENT_P1_PT2,
        VALIDATE_PLACEMENT_P1_PT3,
        VALIDATE_PLACEMENT_P1_PT4,
        PLACE_PIECE_P1,
        COMPLETE_ROW_0_CHECK_BOX_00_P1,
        COMPLETE_ROW_0_CHECK_BOX_01_P1,
        COMPLETE_ROW_0_CHECK_BOX_02_P1,
        COMPLETE_ROW_1_CHECK_BOX_10_P1,
        COMPLETE_ROW_1_CHECK_BOX_11_P1,
        COMPLETE_ROW_1_CHECK_BOX_12_P1,
        COMPLETE_ROW_2_CHECK_BOX_20_P1,
        COMPLETE_ROW_2_CHECK_BOX_21_P1,
        COMPLETE_ROW_2_CHECK_BOX_22_P1,
        COMPLETE_COL_0_CHECK_BOX_00_P1,
        COMPLETE_COL_1_CHECK_BOX_10_P1,
        COMPLETE_COL_2_CHECK_BOX_20_P1,
        COMPLETE_COL_0_CHECK_BOX_01_P1,
        COMPLETE_COL_1_CHECK_BOX_11_P1,
        COMPLETE_COL_2_CHECK_BOX_21_P1,
        COMPLETE_COL_0_CHECK_BOX_02_P1,
        COMPLETE_COL_1_CHECK_BOX_12_P1,
        COMPLETE_COL_2_CHECK_BOX_22_P1,
        COMPLETE_DIA_0_CHECK_BOX_00_P1,
        COMPLETE_DIA_0_CHECK_BOX_11_P1,
        COMPLETE_DIA_0_CHECK_BOX_22_P1,
        COMPLETE_DIA_1_CHECK_BOX_20_P1,
        COMPLETE_DIA_1_CHECK_BOX_11_P1,
        COMPLETE_DIA_1_CHECK_BOX_02_P1,
        HAS_P1_WON,
        SELECT_BOX_P2,
        SELECT_SIZE_P2,
        CHECK_SIZE_SMALL_P2,
        CHECK_SIZE_MED_P2,
        CHECK_SIZE_LARGE_P2,
        VALIDATE_PLACEMENT_P2_PT1,
        VALIDATE_PLACEMENT_P2_PT2,
        VALIDATE_PLACEMENT_P2_PT3,
        VALIDATE_PLACEMENT_P2_PT4,
        PLACE_PIECE_P2,
        COMPLETE_ROW_0_CHECK_BOX_00_P2,
        COMPLETE_ROW_0_CHECK_BOX_01_P2,
        COMPLETE_ROW_0_CHECK_BOX_02_P2,
        COMPLETE_ROW_1_CHECK_BOX_10_P2,
        COMPLETE_ROW_1_CHECK_BOX_11_P2,
        COMPLETE_ROW_1_CHECK_BOX_12_P2,
        COMPLETE_ROW_2_CHECK_BOX_20_P2,
        COMPLETE_ROW_2_CHECK_BOX_21_P2,
        COMPLETE_ROW_2_CHECK_BOX_22_P2,
        COMPLETE_COL_0_CHECK_BOX_00_P2,
        COMPLETE_COL_1_CHECK_BOX_10_P2,
        COMPLETE_COL_2_CHECK_BOX_20_P2,
        COMPLETE_COL_0_CHECK_BOX_01_P2,
        COMPLETE_COL_1_CHECK_BOX_11_P2,
        COMPLETE_COL_2_CHECK_BOX_21_P2,
        COMPLETE_COL_0_CHECK_BOX_02_P2,
        COMPLETE_COL_1_CHECK_BOX_12_P2,
        COMPLETE_COL_2_CHECK_BOX_22_P2,
        COMPLETE_DIA_0_CHECK_BOX_00_P2,
        COMPLETE_DIA_0_CHECK_BOX_11_P2,
        COMPLETE_DIA_0_CHECK_BOX_22_P2,
        COMPLETE_DIA_1_CHECK_BOX_20_P2,
        COMPLETE_DIA_1_CHECK_BOX_11_P2,
        COMPLETE_DIA_1_CHECK_BOX_02_P2,
        HAS_P2_WON,
        DECLARE_P1_WINNER,
        DECLARE_P2_WINNER,
        END                                    // display a crown and `P1` or `P2` for who-ever won. Press any key to go to START state
      };
    }
  }
  
  always {
    we = 0;
    
    ra = 0;
    rb = 0;
    rc = 0;

    asel = 0;
    bsel = 0;
    wdsel = 0;
    ra2sel = 0;
    alufn = 0;
    start = 0;
    finished = 0;
    literal = 0;

    state = 0;
    case(game_state.q) {
      game_state.START:
        if(|c{button_0, button_asterisk, button_hash}) {
          start = 1;
          game_state.d = game_state.SELECT_BOX_P1;
        }
      game_state.SELECT_BOX_P1:
        if(button_1) {
          we = 1;
          ra = regfile_addr.box00;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P1;
        }
        if(button_2) {
          we = 1;
          ra = regfile_addr.box01;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P1;
        }
        if(button_3) {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P1;
        }
        if(button_4) {
          we = 1;
          ra = regfile_addr.box10;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P1;
        }
        if(button_5) {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P1;
        }
        if(button_6) {
          we = 1;
          ra = regfile_addr.box12;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P1;
        }
        if(button_7) {
          we = 1;
          ra = regfile_addr.box20;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P1;
        }
        if(button_8) {
          we = 1;
          ra = regfile_addr.box21;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P1;
        }
        if(button_9) {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P1;
        }
      game_state.SELECT_SIZE_P1:
        if(button_a) {
          we = 1;
          rc = regfile_addr.temp1;
          alufn = alu_op_code.lt;
          asel = 1;
          rb = regfile_addr.pieces_remaining_small_p1;
          game_state.d = game_state.CHECK_SIZE_SMALL_P1;
        }
        if(button_b) {
          we = 1;
          rc = regfile_addr.temp1;
          alufn = alu_op_code.lt;
          asel = 1;
          rb = regfile_addr.pieces_remaining_med_p1;
          game_state.d = game_state.CHECK_SIZE_MED_P1;
        }
        if(button_c) {
          we = 1;
          rc = regfile_addr.temp1;
          alufn = alu_op_code.lt;
          asel = 1;
          rb = regfile_addr.pieces_remaining_large_p1;
          game_state.d = game_state.CHECK_SIZE_LARGE_P1;
        }
        if(button_d) {
          we = 1;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          asel = 1;
          rb = 0;
          game_state.d = game_state.SELECT_BOX_P1;
        }
      game_state.CHECK_SIZE_SMALL_P1:
        rb = regfile_addr.temp1;
        if(rb_data == 0) {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p1;
          alufn = alu_op_code.t_b;
          literal = 1;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.SELECT_BOX_P1;
        } else {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p1;
          alufn = alu_op_code.t_b;
          literal = 1;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.VALIDATE_PLACEMENT_P1_PT1;
        }
      game_state.CHECK_SIZE_MED_P1:
        rb = regfile_addr.temp1;
        if(rb_data == 0) {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p1;
          alufn = alu_op_code.t_b;
          literal = 5;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.SELECT_BOX_P1;
        } else {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p1;
          alufn = alu_op_code.t_b;
          literal = 5;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.VALIDATE_PLACEMENT_P1_PT1;
        }
      game_state.CHECK_SIZE_LARGE_P1:
        rb = regfile_addr.temp1;
        if(rb_data == 0) {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p1;
          alufn = alu_op_code.t_b;
          literal = 9;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.SELECT_BOX_P1;
        } else {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p1;
          alufn = alu_op_code.t_b;
          literal = 9;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.VALIDATE_PLACEMENT_P1_PT1;
        }
      game_state.VALIDATE_PLACEMENT_P1_PT1:
        we = 1;
        ra = rb_data[4:0];
        rc = regfile_addr.temp2;
        alufn = alu_op_code.t_a;
        rb = regfile_addr.box_addr;
        game_state.d = game_state.VALIDATE_PLACEMENT_P1_PT2;
      game_state.VALIDATE_PLACEMENT_P1_PT2:
        we = 1;
        ra = regfile_addr.selected_size_p1;
        rc = regfile_addr.temp3;
        alufn = alu_op_code.sub;
        rb = regfile_addr.temp2;
        game_state.d = game_state.VALIDATE_PLACEMENT_P1_PT3;
      game_state.VALIDATE_PLACEMENT_P1_PT3:
        we = 1;
        ra = regfile_addr.temp3;
        rc = regfile_addr.temp3;
        alufn = alu_op_code.ltq;
        literal = 2;
        bsel = 1;
        game_state.d = game_state.VALIDATE_PLACEMENT_P1_PT4;
      game_state.VALIDATE_PLACEMENT_P1_PT4:
        rb = regfile_addr.temp3;
        if(rb_data == 0) {
          rb = regfile_addr.temp3;
          game_state.d = game_state.PLACE_PIECE_P1;
        } else {
          rb = regfile_addr.temp3;
          game_state.d = game_state.SELECT_BOX_P1;
        }
      game_state.PLACE_PIECE_P1:
        ra2sel = 1;
        we = 1;
        ra = regfile_addr.box_addr;
        alufn = alu_op_code.t_b;
        rb = regfile_addr.selected_size_p1;
        game_state.d = game_state.COMPLETE_ROW_0_CHECK_BOX_00_P1;
      game_state.COMPLETE_ROW_0_CHECK_BOX_00_P1:
        we = 1;
        ra = regfile_addr.box00;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_ROW_0_CHECK_BOX_01_P1;
      game_state.COMPLETE_ROW_0_CHECK_BOX_01_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box01;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_1_CHECK_BOX_10_P1;
        } else {
          we = 1;
          ra = regfile_addr.box01;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_0_CHECK_BOX_02_P1;
        }
      game_state.COMPLETE_ROW_0_CHECK_BOX_02_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_1_CHECK_BOX_10_P1;
        } else {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P1_WON;
        }
      game_state.COMPLETE_ROW_1_CHECK_BOX_10_P1:
        we = 1;
        ra = regfile_addr.box10;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_ROW_1_CHECK_BOX_11_P1;
      game_state.COMPLETE_ROW_1_CHECK_BOX_11_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_2_CHECK_BOX_20_P1;
        } else {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_1_CHECK_BOX_12_P1;
        }
      game_state.COMPLETE_ROW_1_CHECK_BOX_12_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box12;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_2_CHECK_BOX_20_P1;
        } else {
          we = 1;
          ra = regfile_addr.box12;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P1_WON;
        }
      game_state.COMPLETE_ROW_2_CHECK_BOX_20_P1:
        we = 1;
        ra = regfile_addr.box20;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_ROW_2_CHECK_BOX_21_P1;
      game_state.COMPLETE_ROW_2_CHECK_BOX_21_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box21;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_0_CHECK_BOX_00_P1;
        } else {
          we = 1;
          ra = regfile_addr.box21;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_2_CHECK_BOX_22_P1;
        }
      game_state.COMPLETE_ROW_2_CHECK_BOX_22_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_0_CHECK_BOX_00_P1;
        } else {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P1_WON;
        }
      game_state.COMPLETE_COL_0_CHECK_BOX_00_P1:
        we = 1;
        ra = regfile_addr.box00;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_COL_0_CHECK_BOX_01_P1;
      game_state.COMPLETE_COL_1_CHECK_BOX_10_P1:
        we = 1;
        ra = regfile_addr.box10;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_COL_1_CHECK_BOX_11_P1;
      game_state.COMPLETE_COL_2_CHECK_BOX_20_P1:
        we = 1;
        ra = regfile_addr.box20;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_COL_2_CHECK_BOX_21_P1;
      game_state.COMPLETE_COL_0_CHECK_BOX_01_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box01;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_1_CHECK_BOX_10_P1;
        } else {
          we = 1;
          ra = regfile_addr.box01;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_0_CHECK_BOX_02_P1;
        }
      game_state.COMPLETE_COL_1_CHECK_BOX_11_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_2_CHECK_BOX_20_P1;
        } else {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_1_CHECK_BOX_12_P1;
        }
      game_state.COMPLETE_COL_2_CHECK_BOX_21_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box21;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_0_CHECK_BOX_00_P1;
        } else {
          we = 1;
          ra = regfile_addr.box21;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_2_CHECK_BOX_22_P1;
        }
      game_state.COMPLETE_COL_0_CHECK_BOX_02_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_1_CHECK_BOX_10_P1;
        } else {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P1_WON;
        }
      game_state.COMPLETE_COL_1_CHECK_BOX_12_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box12;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_2_CHECK_BOX_20_P1;
        } else {
          we = 1;
          ra = regfile_addr.box12;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P1_WON;
        }
      game_state.COMPLETE_COL_2_CHECK_BOX_22_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_0_CHECK_BOX_00_P1;
        } else {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P1_WON;
        }
      game_state.COMPLETE_DIA_0_CHECK_BOX_00_P1:
        we = 1;
        ra = regfile_addr.box00;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_DIA_0_CHECK_BOX_11_P1;
      game_state.COMPLETE_DIA_0_CHECK_BOX_11_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_1_CHECK_BOX_20_P1;
        } else {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_0_CHECK_BOX_22_P1;
        }
      game_state.COMPLETE_DIA_0_CHECK_BOX_22_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_1_CHECK_BOX_20_P1;
        } else {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P1_WON;
        }
      game_state.COMPLETE_DIA_1_CHECK_BOX_20_P1:
        we = 1;
        ra = regfile_addr.box20;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_DIA_1_CHECK_BOX_11_P1;
      game_state.COMPLETE_DIA_1_CHECK_BOX_11_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.SELECT_BOX_P2;
        } else {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_1_CHECK_BOX_02_P1;
        }
      game_state.COMPLETE_DIA_1_CHECK_BOX_02_P1:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.SELECT_BOX_P2;
        } else {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P1_WON;
        }
      game_state.HAS_P1_WON:
        rb = regfile_addr.temp4;
        if(rb_data == 0) {
          rb = regfile_addr.temp4;
          game_state.d = game_state.SELECT_BOX_P2;
        } else {
          rb = regfile_addr.temp4;
          game_state.d = game_state.DECLARE_P1_WINNER;
        }
      game_state.SELECT_BOX_P2:
        if(button_1) {
          we = 1;
          ra = regfile_addr.box00;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P2;
        }
        if(button_2) {
          we = 1;
          ra = regfile_addr.box01;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P2;
        }
        if(button_3) {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P2;
        }
        if(button_4) {
          we = 1;
          ra = regfile_addr.box10;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P2;
        }
        if(button_5) {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P2;
        }
        if(button_6) {
          we = 1;
          ra = regfile_addr.box12;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P2;
        }
        if(button_7) {
          we = 1;
          ra = regfile_addr.box20;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P2;
        }
        if(button_8) {
          we = 1;
          ra = regfile_addr.box21;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P2;
        }
        if(button_9) {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          game_state.d = game_state.SELECT_SIZE_P2;
        }
      game_state.SELECT_SIZE_P2:
        if(button_a) {
          we = 1;
          rc = regfile_addr.temp1;
          alufn = alu_op_code.lt;
          asel = 1;
          rb = regfile_addr.pieces_remaining_small_p2;
          game_state.d = game_state.CHECK_SIZE_SMALL_P2;
        }
        if(button_b) {
          we = 1;
          rc = regfile_addr.temp1;
          alufn = alu_op_code.lt;
          asel = 1;
          rb = regfile_addr.pieces_remaining_med_p2;
          game_state.d = game_state.CHECK_SIZE_MED_P2;
        }
        if(button_c) {
          we = 1;
          rc = regfile_addr.temp1;
          alufn = alu_op_code.lt;
          asel = 1;
          rb = regfile_addr.pieces_remaining_large_p2;
          game_state.d = game_state.CHECK_SIZE_LARGE_P2;
        }
        if(button_d) {
          we = 1;
          rc = regfile_addr.box_addr;
          alufn = alu_op_code.t_a;
          asel = 1;
          rb = 0;
          game_state.d = game_state.SELECT_BOX_P2;
        }
      game_state.CHECK_SIZE_SMALL_P2:
        rb = regfile_addr.temp1;
        if(rb_data == 0) {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p2;
          alufn = alu_op_code.t_b;
          literal = 2;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.SELECT_BOX_P2;
        } else {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p2;
          alufn = alu_op_code.t_b;
          literal = 2;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.VALIDATE_PLACEMENT_P2_PT1;
        }
      game_state.CHECK_SIZE_MED_P2:
        rb = regfile_addr.temp1;
        if(rb_data == 0) {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p2;
          alufn = alu_op_code.t_b;
          literal = 6;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.SELECT_BOX_P2;
        } else {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p2;
          alufn = alu_op_code.t_b;
          literal = 6;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.VALIDATE_PLACEMENT_P2_PT1;
        }
      game_state.CHECK_SIZE_LARGE_P2:
        rb = regfile_addr.temp1;
        if(rb_data == 0) {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p2;
          alufn = alu_op_code.t_b;
          literal = 10;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.SELECT_BOX_P2;
        } else {
          we = rb_data[0];
          rc = regfile_addr.selected_size_p2;
          alufn = alu_op_code.t_b;
          literal = 10;
          rb = regfile_addr.temp1;
          bsel = 1;
          game_state.d = game_state.VALIDATE_PLACEMENT_P2_PT1;
        }
      game_state.VALIDATE_PLACEMENT_P2_PT1:
        we = 1;
        ra = rb_data[4:0];
        rc = regfile_addr.temp2;
        alufn = alu_op_code.t_a;
        rb = regfile_addr.box_addr;
        game_state.d = game_state.VALIDATE_PLACEMENT_P2_PT2;
      game_state.VALIDATE_PLACEMENT_P2_PT2:
        we = 1;
        ra = regfile_addr.selected_size_p2;
        rc = regfile_addr.temp3;
        alufn = alu_op_code.sub;
        rb = regfile_addr.temp2;
        game_state.d = game_state.VALIDATE_PLACEMENT_P2_PT3;
      game_state.VALIDATE_PLACEMENT_P2_PT3:
        we = 1;
        ra = regfile_addr.temp3;
        rc = regfile_addr.temp3;
        alufn = alu_op_code.ltq;
        literal = 2;
        bsel = 1;
        game_state.d = game_state.VALIDATE_PLACEMENT_P2_PT4;
      game_state.VALIDATE_PLACEMENT_P2_PT4:
        rb = regfile_addr.temp3;
        if(rb_data == 0) {
          rb = regfile_addr.temp3;
          game_state.d = game_state.PLACE_PIECE_P2;
        } else {
          rb = regfile_addr.temp3;
          game_state.d = game_state.SELECT_BOX_P2;
        }
      game_state.PLACE_PIECE_P2:
        ra2sel = 1;
        we = 1;
        ra = regfile_addr.box_addr;
        alufn = alu_op_code.t_b;
        rb = regfile_addr.selected_size_p2;
        game_state.d = game_state.COMPLETE_ROW_0_CHECK_BOX_00_P2;
      game_state.COMPLETE_ROW_0_CHECK_BOX_00_P2:
        we = 1;
        ra = regfile_addr.box00;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_ROW_0_CHECK_BOX_01_P2;
      game_state.COMPLETE_ROW_0_CHECK_BOX_01_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box01;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_1_CHECK_BOX_10_P2;
        } else {
          we = 1;
          ra = regfile_addr.box01;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_0_CHECK_BOX_02_P2;
        }
      game_state.COMPLETE_ROW_0_CHECK_BOX_02_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_1_CHECK_BOX_10_P2;
        } else {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P2_WON;
        }
      game_state.COMPLETE_ROW_1_CHECK_BOX_10_P2:
        we = 1;
        ra = regfile_addr.box10;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_ROW_1_CHECK_BOX_11_P2;
      game_state.COMPLETE_ROW_1_CHECK_BOX_11_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_2_CHECK_BOX_20_P2;
        } else {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_1_CHECK_BOX_12_P2;
        }
      game_state.COMPLETE_ROW_1_CHECK_BOX_12_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box12;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_2_CHECK_BOX_20_P2;
        } else {
          we = 1;
          ra = regfile_addr.box12;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P2_WON;
        }
      game_state.COMPLETE_ROW_2_CHECK_BOX_20_P2:
        we = 1;
        ra = regfile_addr.box20;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_ROW_2_CHECK_BOX_21_P2;
      game_state.COMPLETE_ROW_2_CHECK_BOX_21_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box21;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_0_CHECK_BOX_00_P2;
        } else {
          we = 1;
          ra = regfile_addr.box21;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_ROW_2_CHECK_BOX_22_P2;
        }
      game_state.COMPLETE_ROW_2_CHECK_BOX_22_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_0_CHECK_BOX_00_P2;
        } else {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P2_WON;
        }
      game_state.COMPLETE_COL_0_CHECK_BOX_00_P2:
        we = 1;
        ra = regfile_addr.box00;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_COL_0_CHECK_BOX_01_P2;
      game_state.COMPLETE_COL_1_CHECK_BOX_10_P2:
        we = 1;
        ra = regfile_addr.box10;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_COL_1_CHECK_BOX_11_P2;
      game_state.COMPLETE_COL_2_CHECK_BOX_20_P2:
        we = 1;
        ra = regfile_addr.box20;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_COL_2_CHECK_BOX_21_P2;
      game_state.COMPLETE_COL_0_CHECK_BOX_01_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box01;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_1_CHECK_BOX_10_P2;
        } else {
          we = 1;
          ra = regfile_addr.box01;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_0_CHECK_BOX_02_P2;
        }
      game_state.COMPLETE_COL_1_CHECK_BOX_11_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_2_CHECK_BOX_20_P2;
        } else {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_1_CHECK_BOX_12_P2;
        }
      game_state.COMPLETE_COL_2_CHECK_BOX_21_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box21;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_0_CHECK_BOX_00_P2;
        } else {
          we = 1;
          ra = regfile_addr.box21;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_2_CHECK_BOX_22_P2;
        }
      game_state.COMPLETE_COL_0_CHECK_BOX_02_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_1_CHECK_BOX_10_P2;
        } else {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P2_WON;
        }
      game_state.COMPLETE_COL_1_CHECK_BOX_12_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box12;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_COL_2_CHECK_BOX_20_P2;
        } else {
          we = 1;
          ra = regfile_addr.box12;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P2_WON;
        }
      game_state.COMPLETE_COL_2_CHECK_BOX_22_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_0_CHECK_BOX_00_P2;
        } else {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P2_WON;
        }
      game_state.COMPLETE_DIA_0_CHECK_BOX_00_P2:
        we = 1;
        ra = regfile_addr.box00;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_DIA_0_CHECK_BOX_11_P2;
      game_state.COMPLETE_DIA_0_CHECK_BOX_11_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_1_CHECK_BOX_20_P2;
        } else {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_0_CHECK_BOX_22_P2;
        }
      game_state.COMPLETE_DIA_0_CHECK_BOX_22_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_1_CHECK_BOX_20_P2;
        } else {
          we = 1;
          ra = regfile_addr.box22;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P2_WON;
        }
      game_state.COMPLETE_DIA_1_CHECK_BOX_20_P2:
        we = 1;
        ra = regfile_addr.box20;
        rc = regfile_addr.temp4;
        alufn = alu_op_code.mod;
        literal = 2;
        rb = regfile_addr.temp4;
        bsel = 1;
        game_state.d = game_state.COMPLETE_DIA_1_CHECK_BOX_11_P2;
      game_state.COMPLETE_DIA_1_CHECK_BOX_11_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.SELECT_BOX_P1;
        } else {
          we = 1;
          ra = regfile_addr.box11;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.COMPLETE_DIA_1_CHECK_BOX_02_P2;
        }
      game_state.COMPLETE_DIA_1_CHECK_BOX_02_P2:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.SELECT_BOX_P1;
        } else {
          we = 1;
          ra = regfile_addr.box02;
          rc = regfile_addr.temp4;
          alufn = alu_op_code.mod;
          literal = 2;
          rb = regfile_addr.temp4;
          bsel = 1;
          game_state.d = game_state.HAS_P2_WON;
        }
      game_state.HAS_P2_WON:
        rb = regfile_addr.temp4;
        if(rb_data == 1) {
          rb = regfile_addr.temp4;
          game_state.d = game_state.SELECT_BOX_P1;
        } else {
          rb = regfile_addr.temp4;
          game_state.d = game_state.DECLARE_P2_WINNER;
        }
      game_state.DECLARE_P1_WINNER:
        finished = 1;
        we = 1;
        rc = regfile_addr.winner;
        literal = 1;
        bsel = 1;
        finished = 1;
        game_state.d = game_state.END;
      game_state.DECLARE_P2_WINNER:
        finished = 1;
        we = 1;
        rc = regfile_addr.winner;
        literal = 2;
        bsel = 1;
        finished = 1;
        game_state.d = game_state.END;
      game_state.END:
        finished = 1;
        if(|c{button_0, button_asterisk, button_hash}) {
          finished = 1;
          game_state.d = game_state.START;
        }
  }
}
